<div class="stats-container">
  <!-- Header avec sélection et bouton -->
  <div class="header">
    <h1>Statistiques de Production</h1>
    <div class="controls">
      <div class="week-selector">
        <label for="semaine">Semaine:</label>
        <select 
          id="semaine" 
          [(ngModel)]="semaineSelectionnee" 
          class="semaine-select">
          <option *ngFor="let num of getSemainesArray()" [value]="'semaine' + num">
            Semaine {{ num }}
          </option>
        </select>
      </div>
      <button 
        class="btn-charger" 
        (click)="chargerStatistiques()"
        [disabled]="isLoading">
        <span *ngIf="!isLoading"> Afficher les Statistiques</span>
        <span *ngIf="isLoading"> Chargement...</span>
      </button>
    </div>
  </div>

  <!-- Message de chargement -->
  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Chargement des statistiques...</p>
  </div>

  <!-- Contenu des statistiques -->
  <div *ngIf="showStats && !isLoading" class="content-wrapper">
    <!-- Sidebar avec les lignes -->
    <div class="sidebar">
      <h2>Lignes de Production</h2>
      <div class="lignes-list">
        <div 
          *ngFor="let ligne of statsLignes" 
          class="ligne-item"
          [class.selected]="ligne.ligne === ligneSelectionnee"
          (click)="selectionnerLigne(ligne.ligne)">
          <div class="ligne-header">
            <span class="ligne-nom">{{ ligne.ligne }}</span>
            <span class="ligne-percentage">{{ ligne.pcsProdTotal.toFixed(2) }}%</span>
          </div>
          <div class="ligne-bar-container">
            <div 
              class="ligne-bar" 
              [style.width.%]="ligne.pcsProdTotal"
              [style.background-color]="getColorForPercentage(ligne.pcsProdTotal)">
            </div>
          </div>
          <div class="ligne-info">
            <small>Rendement</small>
          </div>
        </div>
      </div>
    </div>

    <!-- Zone des graphiques -->
    <div class="charts-area">
      <!-- Histogramme -->
      <div class="chart-container">
        <h3>Production par Ligne - {{ semaineSelectionnee }}</h3>
        <canvas id="barChart"></canvas>
      </div>

      <!-- Graphiques circulaires -->
      <div class="pie-charts-container">
        <div 
          *ngFor="let ligne of statsLignes" 
          class="pie-chart-wrapper">
          <h4>{{ ligne.ligne }}</h4>
          <div class="pie-canvas-wrapper">
            <canvas [id]="'pieChart-' + ligne.ligne"></canvas>
            <div class="pie-center-text">
              <span class="percentage">{{ ligne.pcsProdTotal.toFixed(0) }}%</span>
              <span class="label">rendement</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Message initial -->
  <div *ngIf="!showStats && !isLoading" class="welcome-message">
    <div class="welcome-icon"></div>
    <h2>Bienvenue aux Statistiques</h2>
    <p>Sélectionnez une semaine et cliquez sur "Afficher les Statistiques" pour voir les données de production.</p>
  </div>
</div>